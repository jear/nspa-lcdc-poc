root@ansiblemachine:/ansible# ansible-doc vmware.ansible_for_nsxt.nsxt_policy_tier1
> MODULE vmware.ansible_for_nsxt.nsxt_policy_tier1 (/root/.ansible/collections/ansible_collections/vmware/ansible_for_nsxt/plugins/modules/nsxt_policy_>

  Creates/Updates/Deletes a Tier-1 resource using the Policy API. Assocaited resources include 'Tier-1 Locale Service'
  and 'Tier-1 Interface'. 'Tier-1 Locale Service' and 'Tier-1 Interface' attributes must be prepended with 't1ls' and
  't1iface' respectively.

OPTIONS (red indicates it is required):

   achieve_subresource_state_if_del_parent  Can be used to achieve the state of subresources even if the parent(base)
                                            resource's state is absent.
                                            Can be specified for each subresource.
        default: false
        type: bool

   ca_path  Path to the CA bundle to be used to verify host's SSL certificate
        default: null
        type: str

   create_or_update_subresource_first  Can be used to create subresources first.
                                       Can be specified for each subresource.
        default: false
        type: bool

   default_rule_logging  Enable logging for whitelisted rule. Indicates if logging should be enabled for the default
                         whitelisting rule.
        default: false

   delete_subresource_first  Can be used to delete subresources first.
                             Can be specified for each subresource.
        default: true
        type: bool

   description  Tier-1 description
        default: null
        type: str

   dhcp_config_display_name  Same as dhcp_config_id. Either one can be specified. If both are specified, dhcp_config_id
                             takes precedence.
        default: null
        type: str

   dhcp_config_id  DHCP configuration for Segments connected to Tier-1. DHCP service is configured in relay mode.
        default: null
        type: str

   disable_firewall  Disable or enable gateway fiewall.
        default: false
        type: bool

   display_name  Display name.
                 If resource ID is not specified, display_name will be used as ID.
        default: null
        type: str

   do_wait_till_create  Can be used to wait for the realization of subresource before the request to create the next
                        resource is sent to the Manager.
                        Can be specified for each subresource.
        default: false
        type: bool

   enable_standby_relocation  Flag to enable standby service router relocation.
                              Standby relocation is not enabled until edge cluster is configured for Tier1.
        default: false
        type: bool

   failover_mode  Determines the behavior when a Tier-1 instance in ACTIVE-STANDBY high-availability mode restarts after
                  a failure. If set to PREEMPTIVE, the preferred node will take over, even if it causes another failure.
                  If set to NON_PREEMPTIVE, then the instance that restarted will remain secondary. This property must
                  not be populated unless the ha_mode property is set to ACTIVE_STANDBY.
        choices: [NON_PREEMPTIVE, PREEMPTIVE]
        default: NON_PREEMPTIVE
        type: str

   force_whitelisting  Flag to add whitelisting FW rule during realization.
        default: false
        type: bool

   hostname  Deployed NSX manager hostname.
        type: str

   id      Tier-1 ID
        default: null
        type: str

   intersite_config  Inter site routing configuration when the gateway is streched.
        default: null
        type: dict
        suboptions:

           fallback_sites  Fallback site to be used as new primary site on current primary site failure. Disaster
                           recovery must be initiated via API/UI. Fallback site configuration is supported only for T0
                           gateway. T1 gateway will follow T0 gateway's primary site during disaster recovery
          default: null
          type: list

           intersite_transit_subnet  Transit subnet in CIDR format
                                     IPv4 subnet for inter-site transit segment connecting service routers across sites
                                     for stretched gateway. For IPv6 link local subnet is auto configured
          default: 169.254.32.0/20
          type: str

           last_admin_active_epoch  Epoch of last time admin changing active LocaleServices
                                    Epoch(in seconds) is auto updated based on system current timestamp when primary
                                    locale service is updated. It is used for resolving conflict during site failover. If
                                    system clock not in sync then User can optionally override this. New value must be
                                    higher than the current value.
          default: null
          type: int

           primary_site_path  Primary egress site for gateway.
                              Primary egress site for gateway. T0/T1 gateway in Active/Standby mode supports stateful
                              services on primary site. In this mode primary site must be set if gateway is stretched to
                              more than one site. For T0 gateway in Active/Active primary site is optional field. If set
                              then secondary site prefers routes learned from primary over locally learned routes. This
                              field is not applicable for T1 gateway with no services
          default: null
          type: str

   ipv6_dad_profile_display_name  Same as ipv6_dad_profile_id. Either one can be specified. If both are specified,
                                  ipv6_dad_profile_id takes precedence.
        default: null
        type: str

   ipv6_dad_profile_id  IPv6 DRA profile configuration on Tier1. Either or both NDRA and/or DAD profiles can be
                        configured. Related attribute ipv6_ndra_profile_id.
        default: null
        type: str

   ipv6_ndra_profile_display_name  Same as ipv6_ndra_profile_id. Either one can be specified. If both are specified,
                                   ipv6_ndra_profile_id takes precedence.
        default: null
        type: str

   ipv6_ndra_profile_id  IPv6 NDRA profile configuration on Tier1. Either or both NDRA and/or DAD profiles can be
                         configured. Related attribute ipv6_dad_profile_id.
        default: null
        type: str

   locale_services  This is a list of Locale Services that need to be created, updated, or deleted
        default: null
        element: dict
        type: list
        suboptions:

           achieve_subresource_state_if_del_parent  Can be used to achieve the state of subresources even if the
                                                    parent(base) resource's state is absent.
                                                    Can be specified for each subresource.
          default: false
          type: bool

           description  Tier-1 Locale Service  description
          default: null
          type: str

           display_name  Tier-1 Locale Service display name.
                         Either this or id must be specified. If both are specified, id takes precedence.
          default: null
          type: str

           do_wait_till_create  Can be used to wait for the realization of subresource before the request to create the
                                next resource is sent to the Manager
          default: false
          type: bool

           edge_cluster_info  Used to create path to edge cluster. Auto-assigned if associated enforcement-point has only
                              one edge cluster.
          default: null
          type: dict
          suboptions:

             edge_cluster_display_name  display name of the edge cluster.
                                        Either this or edge_cluster_id must be specified. If both are specified,
                                        edge_cluster_id takes precedence
            default: null
            type: str

             edge_cluster_id  ID of the edge cluster
            type: str

             enforcementpoint_id  enforcementpoint_id where edge cluster is located
            default: default
            type: str

             site_id  site_id where edge cluster is located
            default: default
            type: str

           ha_vip_configs  Array of HA VIP Config.
                           This configuration can be defined only for Active-Standby Tier0 gateway to provide redundancy.
                           For mulitple external interfaces, multiple HA VIP configs must be defined and each config will
                           pair exactly two external interfaces. The VIP will move and will always be owned by the Active
                           node. When this property is configured, configuration of dynamic-routing is not allowed.
          default: null
          elements: dict
          type: list
          suboptions:

             enabled  Flag to enable this HA VIP config.
            default: true
            type: bool

             external_interface_paths  Policy paths to Tier0 external interfaces for providing redundancy
                                       Policy paths to Tier0 external interfaces which are to be paired to provide
                                       redundancy. Floating IP will be owned by one of these interfaces depending upon
                                       which edge node is Active.
            default: null
            type: list

             vip_subnets  VIP floating IP address subnets
                          Array of IP address subnets which will be used as floating IP addresses.
            default: null
            type: list
            suboptions:

               ip_addresses  IP addresses assigned to interface
              type: list

               prefix_len  Subnet prefix length
              type: int

           id  Tier-1 Locale Service ID
          default: null
          type: str

           interfaces  Specify the interfaces associated with the Gateway in this section that need to be created,
                       updated, or deleted
          default: null
          element: dict
          type: list
          suboptions:

             achieve_subresource_state_if_del_parent  Can be used to achieve the state of subresources even if the
                                                      parent(base) resource's state is absent.
                                                      Can be specified for each subresource.
            default: false
            type: bool

             description  Tier-1 Interface  description
            default: null
            type: str

             display_name  Tier-1 Interface display name
                           Either this or id must be specified. If both are specified, id takes precedence.
            default: null
            type: str

             do_wait_till_create  Can be used to wait for the realization of subresource before the request to create the
                                  next resource is sent to the Manager
            default: false
            type: bool

             id  Tier-1 Interface ID
            default: null
            type: str

             ipv6_ndra_profile_id  Configrue IPv6 NDRA profile. Only one NDRA profile can be configured
                                   Required if id != null
            default: null
            type: str

             mtu  MTU size
                  Maximum transmission unit (MTU) specifies the size of the largest packet that a network protocol can
                  transmit.
            default: null
            type: int

             segment_display_name  Same as segment_id
                                   Either this or segment_id must be specified. If both are specified, segment_id takes
                                   precedence.
            default: null
            type: str

             segment_id  Specify Segment to which this interface is connected to.
                         Required if id != null
            default: null
            type: str

             state  State can be either 'present' or 'absent'. 'present' is used to create or update resource. 'absent'
                    is used to delete resource.
                    Required if segp_id != null.
            choices: [present, absent]
            default: null

             subnets  IP address and subnet specification for interface
                      Specify IP address and network prefix for interface
                      Required if id != null
            default: null
            elements: dict
            type: list
            suboptions:

               ip_addresses  IP addresses assigned to interface
              default: null
              type: str

               prefix_len  Subnet prefix length
              default: null
              type: str

             tags  Opaque identifiers meaningful to the API user
            default: null
            type: dict
            suboptions:

               scope  Tag scope.
              type: str

               tag  Tag value.
              type: str

             urpf_mode  Unicast Reverse Path Forwarding mode
            choices: [NONE, STRICT]
            default: STRICT
            type: str

           preferred_edge_nodes_info  Used to create paths to edge nodes. Specified edge is used as preferred edge
                                      cluster member when failover mode is set to PREEMPTIVE, not applicable otherwise.
          default: null
          type: list
          suboptions:

             edge_cluster_display_name  display name of the edge cluster.
                                        either this or edge_cluster_id must be specified. If both are specified,
                                        edge_cluster_id takes precedence
            default: null
            type: str

             edge_cluster_id  edge_cluster_id where edge node is located
            type: str

             edge_node_display_name  Display name of the edge node.
                                     either this or edge_node_id must be specified. If both are specified, edge_node_id
                                     takes precedence
            default: null
            type: str

             edge_node_id  ID of the edge node
            default: null
            type: str

             enforcementpoint_id  enforcementpoint_id where edge node is located
            default: default
            type: str

             site_id  site_id where edge node is located
            default: default
            type: str

           route_redistribution_config  Configure all route redistribution properties like enable/disable redistributon,
                                        redistribution rule and so on.
          default: null
          type: dict
          suboptions:

             bgp_enabled  Flag to enable route redistribution.
            default: false
            type: bool

             redistribution_rules  List of redistribution rules.
            default: null
            elements: dict
            type: list
            suboptions:

               name  Rule name
              default: null
              type: str

               route_map_path  Route map to be associated with the redistribution rule
              default: null
              type: str

               route_redistribution_types  Tier-0 route redistribution types
              choices: [TIER0_STATIC - Redistribute user added static routes., 'TIER0_CONNECTED - Redistribute
                  all subnets configured on Interfaces and routes related to TIER0_ROUTER_LINK,
                  TIER0_SEGMENT, TIER0_DNS_FORWARDER_IP, TIER0_IPSEC_LOCAL_IP, TIER0_NAT types.',
                TIER1_STATIC - Redistribute all subnets and static routes advertised by Tier-1s.,
                TIER0_EXTERNAL_INTERFACE - Redistribute external interface subnets on Tier-0., TIER0_LOOPBACK_INTERFACE
                  - Redistribute loopback interface subnets on Tier-0., TIER0_SEGMENT - Redistribute
                  subnets configured on Segments connected to Tier-0., TIER0_ROUTER_LINK - Redistribute
                  router link port subnets on Tier-0., TIER0_SERVICE_INTERFACE - Redistribute Tier0
                  service interface subnets., TIER0_DNS_FORWARDER_IP - Redistribute DNS forwarder
                  subnets., TIER0_IPSEC_LOCAL_IP - Redistribute IPSec subnets., TIER0_NAT - Redistribute
                  NAT IPs owned by Tier-0., TIER0_EVPN_TEP_IP - Redistribute EVPN local endpoint
                  subnets on Tier-0., TIER1_NAT - Redistribute NAT IPs advertised by Tier-1 instances.,
                TIER1_LB_VIP - Redistribute LB VIP IPs advertised by Tier-1 instances., TIER1_LB_SNAT
                  - Redistribute LB SNAT IPs advertised by Tier-1 instances., TIER1_DNS_FORWARDER_IP
                  - Redistribute DNS forwarder subnets on Tier-1 instances., TIER1_CONNECTED - Redistribute
                  all subnets configured on Segments and Service Interfaces., TIER1_SERVICE_INTERFACE
                  - Redistribute Tier1 service interface subnets., TIER1_SEGMENT - Redistribute
                  subnets configured on Segments connected to Tier1., TIER1_IPSEC_LOCAL_ENDPOINT
                  - Redistribute IPSec VPN local-endpoint subnets advertised by TIER1.]
              default: null
              type: list

           route_redistribution_types  Enable redistribution of different types of routes on Tier-0.
                                       This property is only valid for locale-service under Tier-0.
                                       This property is deprecated, please use "route_redistribution_config" property to
                                       configure redistribution rules.
          choices: [TIER0_STATIC - Redistribute user added static routes., 'TIER0_CONNECTED - Redistribute
              all subnets configured on Interfaces and routes related to TIER0_ROUTER_LINK,
              TIER0_SEGMENT, TIER0_DNS_FORWARDER_IP, TIER0_IPSEC_LOCAL_IP, TIER0_NAT types.',
            TIER1_STATIC - Redistribute all subnets and static routes advertised by Tier-1s.,
            TIER0_EXTERNAL_INTERFACE - Redistribute external interface subnets on Tier-0., TIER0_LOOPBACK_INTERFACE
              - Redistribute loopback interface subnets on Tier-0., TIER0_SEGMENT - Redistribute
              subnets configured on Segments connected to Tier-0., TIER0_ROUTER_LINK - Redistribute
              router link port subnets on Tier-0., TIER0_SERVICE_INTERFACE - Redistribute Tier0
              service interface subnets., TIER0_DNS_FORWARDER_IP - Redistribute DNS forwarder
              subnets., TIER0_IPSEC_LOCAL_IP - Redistribute IPSec subnets., TIER0_NAT - Redistribute
              NAT IPs owned by Tier-0., TIER0_EVPN_TEP_IP - Redistribute EVPN local endpoint
              subnets on Tier-0., TIER1_NAT - Redistribute NAT IPs advertised by Tier-1 instances.,
            TIER1_LB_VIP - Redistribute LB VIP IPs advertised by Tier-1 instances., TIER1_LB_SNAT
              - Redistribute LB SNAT IPs advertised by Tier-1 instances., TIER1_DNS_FORWARDER_IP
              - Redistribute DNS forwarder subnets on Tier-1 instances., TIER1_CONNECTED - Redistribute
              all subnets configured on Segments and Service Interfaces., TIER1_SERVICE_INTERFACE
              - Redistribute Tier1 service interface subnets., TIER1_SEGMENT - Redistribute
              subnets configured on Segments connected to Tier1., TIER1_IPSEC_LOCAL_ENDPOINT
              - Redistribute IPSec VPN local-endpoint subnets advertised by TIER1.]
          default: null
          type: list

           state  State can be either 'present' or 'absent'. 'present' is used to create or update resource. 'absent' is
                  used to delete resource.
                  Required if segp_id != null
          choices: [present, absent]
          default: null

           tags  Opaque identifiers meaningful to the API user.
          default: null
          type: dict
          suboptions:

             scope  Tag scope.
            type: str

             tag  Tag value.
            type: str

   nsx_cert_path  Path to the certificate created for the Principal Identity using which the CRUD operations should be
                  performed
        default: null
        type: str

   nsx_key_path  Path to the certificate key created for the Principal Identity using which the CRUD operations should be
                 performed
                 Must be specified if nsx_cert_path is specified
        default: null
        type: str

   password  The password to authenticate with the NSX manager.
             Must be specified if username is specified
        default: null
        type: str

   pool_allocation  Edge node allocation size
                    Supports edge node allocation at different sizes for routing and load balancer service to meet
                    performance and scalability requirements.
                    ROUTING - Allocate edge node to provide routing services.
                    LB_SMALL, LB_MEDIUM, LB_LARGE, LB_XLARGE - Specify size of load balancer service that will be
                    configured on TIER1 gateway.
        choices: [ROUTING, LB_SMALL, LB_MEDIUM, LB_LARGE, LB_XLARGE]
        default: ROUTING
        type: str

   qos_profile  QoS Profile configuration for Tier1 router link connected to Tier0 gateway.
        default: null
        type: dict
        suboptions:

           egress_qos_profile_path  Policy path to gateway QoS profile in egress direction.
          default: null
          type: str

           ingress_qos_profile_path  Policy path to gateway QoS profile in ingress direction.
          default: null
          type: str

   request_headers  HTTP request headers to be sent to the host while making any request
        default: null
        type: dict

   route_advertisement_rules  Route advertisement rules and filtering
        default: null
        type: list
        suboptions:

           action  Action to advertise filtered routes to the connected Tier0 gateway.
          choices: [{PERMIT: Enables the advertisment}, {DENY: Disables the advertisement}]
          type: str

           name  Display name for rule
          type: str

           prefix_operator  Prefix operator to filter subnets.
                            GE prefix operator filters all the routes with prefix length greater than or equal to the
                            subnets configured.
                            EQ prefix operator filter all the routes with prefix length equal to the subnets configured.
          choices: [GE, EQ]
          default: null
          type: str

           route_advertisement_types  Enable different types of route advertisements.
                                      By default, Routes to IPSec VPN local-endpoint subnets (TIER1_IPSEC_LOCAL_ENDPOINT)
                                      are advertised if no value is supplied here.
          choices: [TIER1_STATIC_ROUTES, TIER1_CONNECTED, TIER1_NAT, TIER1_LB_VIP, TIER1_LB_SNAT, TIER1_DNS_FORWARDER_IP,
            TIER1_IPSEC_LOCAL_ENDPOINT]
          default: null
          type: list

           subnets  Network CIDRs to be routed.
          default: null
          type: list

   route_advertisement_types  Enable different types of route advertisements.
                              By default, Routes to IPSec VPN local-endpoint subnets (TIER1_IPSEC_LOCAL_ENDPOINT) are
                              advertised if no value is supplied here.
        choices: [TIER1_STATIC_ROUTES, TIER1_CONNECTED, TIER1_NAT, TIER1_LB_VIP, TIER1_LB_SNAT, TIER1_DNS_FORWARDER_IP,
          TIER1_IPSEC_LOCAL_ENDPOINT]
        default: null
        type: list

   state   State can be either 'present' or 'absent'. 'present' is used to create or update resource. 'absent' is used to
           delete resource.
        choices: [present, absent]

   static_routes  This is a list of Static Routes that need to be created, updated, or deleted
        default: null
        element: dict
        type: list
        suboptions:

           achieve_subresource_state_if_del_parent  Can be used to achieve the state of subresources even if the
                                                    parent(base) resource's state is absent.
                                                    Can be specified for each subresource.
          default: false
          type: bool

           description  Tier-1 Static Route description.
          default: null
          type: str

           display_name  Tier-1 Static Route display name.
                         Either this or id must be specified. If both are specified, id takes precedence.
          default: null
          type: str

           do_wait_till_create  Can be used to wait for the realization of subresource before the request to create the
                                next resource is sent to the Manager
          default: false
          type: bool

           id  Tier-1 Static Route ID.
          default: null
          type: str

           network  Network address in CIDR format
          type: str

           next_hops  Next hop routes for network
          default: null
          elements: dict
          ip_address:
            description: Next hop gateway IP address
            type: str
          scope:
            description:
            - Interface path associated with current route
            - For example, specify a policy path referencing the IPSec VPN Session
            type: list
          type: list
          suboptions:

             admin_distance  Cost associated with next hop route
            default: 1
            type: int

           state  State can be either 'present' or 'absent'. 'present' is used to create or update resource. 'absent' is
                  used to delete resource.
                  Must be specified in order to modify the resource
          choices: [present, absent]
          default: null

           tags  Opaque identifiers meaningful to the API user
          default: null
          type: dict
          suboptions:

             scope  Tag scope.
            type: str

             tag  Tag value.
            type: str

   tags    Opaque identifiers meaningful to the API user.
        default: null
        type: dict
        suboptions:

           scope  Tag scope.
          type: str

           tag  Tag value.
          type: str

   tier0_display_name  Same as tier0_id. Either one can be specified. If both are specified, tier0_id takes precedence.
        default: null
        type: str

   tier0_id  Tier-1 connectivity to Tier-0
        default: null
        type: str

   username  The username to authenticate with the NSX manager.
        default: null
        type: str

   validate_certs  Enable server certificate verification.
        default: false
        type: bool

AUTHOR: Gautam Verma

METADATA:           metadata_version: '1.1'
          status:
          - preview
          supported_by: community

EXAMPLES:
- name: create Tier1
  nsxt_policy_tier1:
    hostname: "10.10.10.10"
    nsx_cert_path: /root/com.vmware.nsx.ncp/nsx.crt
    nsx_key_path: /root/com.vmware.nsx.ncp/nsx.key
    validate_certs: False
    display_name: test-tier22222
    state: present
    failover_mode: "PREEMPTIVE"
    disable_firewall: True
    force_whitelisting: True
    enable_standby_relocation: False
    tags:
      - scope: "a"
        tag: "b"
    route_advertisement_rules:
      - name: "test-route-advertisement-rules"
        route_advertisement_types: ['TIER1_STATIC_ROUTES', 'TIER1_CONNECTED']
        subnets: ["35.1.1.1/23"]
    route_advertisement_types:
        - "TIER1_STATIC_ROUTES"
        - "TIER1_CONNECTED"
        - "TIER1_NAT"
    tier0_display_name: "node-t0"
    locale_services:
      - state: present
        display_name: test-t1ls-2
        route_redistribution_config:
          redistribution_rules:
            - name: abc
              route_redistribution_types: ["TIER0_STATIC", "TIER0_NAT"]
        interfaces:
          - id: "test-t1-t1ls-iface-2"
            display_name: "test-t1-t1ls-iface"
            state: present
            subnets:
              - ip_addresses: ["35.1.1.1"]
                prefix_len: 24
            segment_id: "test-seg-2"
            ipv6_ndra_profile_id: test
            mtu: 1400
            urpf_mode: NONE

